(this["webpackJsonpcelo-ecommerce-dapp"]=this["webpackJsonpcelo-ecommerce-dapp"]||[]).push([[0],{403:function(e){e.exports=JSON.parse('[{"inputs":[{"internalType":"uint256","name":"_index","type":"uint256"}],"name":"buyProduct","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getProductsLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_index","type":"uint256"}],"name":"readProduct","outputs":[{"internalType":"address payable","name":"","type":"address"},{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"string","name":"_image","type":"string"},{"internalType":"string","name":"_description","type":"string"},{"internalType":"string","name":"_location","type":"string"},{"internalType":"uint256","name":"_price","type":"uint256"}],"name":"writeProduct","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},404:function(e){e.exports=JSON.parse('[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}]')},412:function(e,t,n){},414:function(e,t,n){},430:function(e,t){},431:function(e,t){},433:function(e,t){},437:function(e,t){},461:function(e,t){},463:function(e,t){},477:function(e,t){},479:function(e,t){},507:function(e,t){},509:function(e,t){},526:function(e,t){},527:function(e,t){},600:function(e,t){},601:function(e,t){},693:function(e,t){},698:function(e,t){},880:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(59),s=n.n(c),i=(n(412),n(96)),o=n(18),u=n(28),l=n.n(u),p=(n(414),n(889)),d=n(883),b=n(888),y=n(884),j=n(885),m=n(891),f=n(890),x=n(398),h=n(1),O=function(e){var t=Object(a.useState)(""),n=Object(o.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(""),i=Object(o.a)(s,2),u=i[0],l=i[1],O=Object(a.useState)(""),g=Object(o.a)(O,2),v=g[0],w=g[1],T=Object(a.useState)(""),C=Object(o.a)(T,2),k=C[0],N=C[1],S=Object(a.useState)(0),P=Object(o.a)(S,2),B=P[0],F=P[1],D=Object(a.useState)(!1),I=Object(o.a)(D,2),M=I[0],A=I[1],E=function(){return A(!1)};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(p.a,{bg:"light",children:Object(h.jsxs)(d.a,{children:[Object(h.jsx)(p.a.Brand,{href:"#home",children:"Celo-Ecommerce-marketplace"}),Object(h.jsx)(p.a.Toggle,{}),Object(h.jsx)(b.a,{className:"me-auto",children:Object(h.jsxs)(y.a,{bg:"secondary",className:"ms-auto",children:["Balance ",e.cUSDBalance,"cUSD"]})}),Object(h.jsx)(p.a.Collapse,{className:"justify-content-end",children:Object(h.jsx)(j.a,{onClick:function(){return A(!0)},variant:"dark",children:Object(h.jsx)("h5",{children:" Add new product "})})})]})}),Object(h.jsxs)(m.a,{show:M,onHide:E,centered:!0,children:[Object(h.jsx)(m.a.Header,{closeButton:!0,children:Object(h.jsx)(m.a.Title,{children:"New Product"})}),Object(h.jsx)(f.a,{children:Object(h.jsxs)(m.a.Body,{children:[Object(h.jsx)(x.a,{controlId:"inputName",label:"Product Name",className:"mb-3",children:Object(h.jsx)(f.a.Control,{type:"text",onChange:function(e){c(e.target.value)},placeholder:"name"})}),Object(h.jsx)(x.a,{controlId:"inputImage",label:"Image",className:"mb-3",children:Object(h.jsx)(f.a.Control,{type:"text",onChange:function(e){l(e.target.value)},placeholder:"Image"})}),Object(h.jsx)(x.a,{controlId:"inputDescription",label:"Description",className:"mb-3",children:Object(h.jsx)(f.a.Control,{as:"textarea",placeholder:"description",style:{height:"80px"},onChange:function(e){w(e.target.value)}})}),Object(h.jsx)(x.a,{controlId:"inputLocation",label:"location",className:"mb-3",children:Object(h.jsx)(f.a.Control,{type:"text",onChange:function(e){N(e.target.value)},placeholder:"location"})}),Object(h.jsx)(x.a,{controlId:"inputPrice",label:"price",className:"mb-3",children:Object(h.jsx)(f.a.Control,{type:"number",onChange:function(e){F(e.target.value)},placeholder:"price"})})]})}),Object(h.jsxs)(m.a.Footer,{children:[Object(h.jsx)(j.a,{variant:"outline-secondary",onClick:E,children:"Close"}),Object(h.jsx)(j.a,{variant:"dark",disabled:!(r&&u&&v&&k&&B),onClick:function(){e.addProduct(r,u,v,k,B),E()},children:"Add Product"})]})]})]})},g=n(886),v=n(397),w=n(892),T=n(893),C=function(e){return Object(h.jsx)(g.a,{xs:1,md:3,className:"g-4",children:e.products.map((function(t){return Object(h.jsx)(v.a,{children:Object(h.jsxs)(w.a,{className:"h-100",children:[Object(h.jsx)(w.a.Header,{children:Object(h.jsxs)(T.a,{direction:"horizontal",gap:2,children:[Object(h.jsxs)(y.a,{bg:"secondary",className:"ms-auto",children:[t.index," ID"]}),Object(h.jsxs)(y.a,{bg:"secondary",className:"ms-auto",children:[t.price/1e18,"cUSD"]}),Object(h.jsxs)(y.a,{bg:"secondary",className:"ms-auto",children:[t.sold," Sold"]})]})}),Object(h.jsx)("div",{className:" ratio ratio-4x3",children:Object(h.jsx)("img",{src:t.image,alt:t.description,style:{objectFit:"cover"}})}),Object(h.jsxs)(w.a.Body,{className:"d-flex  flex-column text-center",children:[Object(h.jsx)(w.a.Title,{className:"flex-grow-1",children:t.name}),Object(h.jsx)(w.a.Text,{className:"flex-grow-1",children:t.description}),e.walletAddress!==t.owner&&Object(h.jsx)("button",{type:"button",onClick:function(){return e.buyProduct(t.index)},class:"btn btn-dark mt-1",children:"Buy"})]})]})},t.index)}))})},k=n(399),N=n.n(k),S=n(402),P=n(403),B=n(404),F=n(30),D=n.n(F),I="0x86B54C4b5c8a6f2e65bd3A5c3157990B5cD1e18c";var M=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(o.a)(c,2),u=s[0],p=s[1],d=Object(a.useState)(null),b=Object(o.a)(d,2),y=b[0],j=b[1],m=Object(a.useState)(0),f=Object(o.a)(m,2),x=f[0],g=f[1],v=Object(a.useState)([]),w=Object(o.a)(v,2),T=w[0],k=w[1],F=function(){var e=Object(i.a)(l.a.mark((function e(){var t,n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.celo){e.next=22;break}return e.prev=1,e.next=4,window.celo.enable();case 4:return t=new N.a(window.celo),n=Object(S.newKitFromWeb3)(t),e.next=8,n.web3.eth.getAccounts();case 8:return a=e.sent,r=a[0],n.defaultAccount=r,e.next=13,p(r);case 13:return e.next=15,j(n);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.log(e.t0);case 20:e.next=23;break;case 22:alert("Error Occurred");case 23:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(){return e.apply(this,arguments)}}(),M=Object(a.useCallback)(Object(i.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.getTotalBalance(u);case 3:t=e.sent,n=t.cUSD.shiftedBy(-18).toFixed(2),a=new y.web3.eth.Contract(P,I),r(a),g(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),[u,y]),A=Object(a.useCallback)(Object(i.a)(l.a.mark((function e(){var t,a,r,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.methods.getProductsLength().call();case 2:for(t=e.sent,a=[],r=function(e){var t=new Promise(function(){var t=Object(i.a)(l.a.mark((function t(a,r){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.methods.readProduct(e).call();case 2:c=t.sent,a({index:e,owner:c[0],name:c[1],image:c[2],description:c[3],location:c[4],price:c[5],sold:c[6]});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());a.push(t)},c=0;c<t;c++)r(c);return e.next=8,Promise.all(a);case 8:s=e.sent,k(s);case 10:case"end":return e.stop()}}),e)}))),[n]),E=function(){var e=Object(i.a)(l.a.mark((function e(t,a,r,c,s,i){var o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new D.a(s).shiftedBy(18).toString(),e.prev=1,e.next=4,n.methods.writeProduct(t,a,r,c,o).send({from:u});case 4:A(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n,a,r,c,s){return e.apply(this,arguments)}}(),_=function(){var e=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new y.web3.eth.Contract(B,"0x874069Fa1Eb16D44d622F2e0Ca25eeA172369bC1"),console.log(),e.next=5,a.methods.approve(I,T[t].price).send({from:u});case 5:return e.next=7,n.methods.buyProduct(t).send({from:u});case 7:A(),M(),alert("you have successfully bought this product"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),alert(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){F()}),[]),Object(a.useEffect)((function(){y&&u&&M()}),[y,u,M]),Object(a.useEffect)((function(){n&&A()}),[n,A]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(O,{cUSDBalance:x,addProduct:E}),Object(h.jsx)(C,{products:T,buyProduct:_,walletAddress:u})]})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,894)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};n(876),n(877);s.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(M,{})}),document.getElementById("root")),A()}},[[880,1,2]]]);
//# sourceMappingURL=main.8cb09630.chunk.js.map